import{_ as j,r as c,c as m,o as O,b as o,d as e,e as x,g as F,t as l,f as k,w as u,v as D,F as _,h as I,x as H,m as C,S as b,i,n as J}from"./index-BJk99QVQ.js";const W={class:"d-flex flex-column gap-6 py-4 px-2 bg-light min-vh-100"},K={class:"card card-flush border-0 shadow-sm bg-light-primary"},Y={class:"card-body p-5 d-flex flex-column flex-md-row align-items-center justify-content-between gap-3"},G={class:"badge badge-light-info"},Q={class:"card card-flush"},X={class:"card-header align-items-center py-4 gap-2 gap-md-5"},Z={class:"card-title"},ee={class:"d-flex align-items-center position-relative my-1"},te={class:"card-toolbar gap-4"},se={class:"bg-white rounded p-2 px-4 shadow-sm text-center"},ae={class:"fs-3 fw-bold text-success"},ne={class:"bg-white rounded p-2 px-4 shadow-sm text-center"},le={class:"fs-3 fw-bold text-primary"},oe={class:"bg-white rounded p-2 px-4 shadow-sm text-center"},ie={class:"fs-3 fw-bold text-warning"},re={class:"bg-white rounded p-2 px-4 shadow-sm text-center"},de={class:"fs-3 fw-bold text-info"},ce={class:"alert bg-light-info border-0 py-3 px-5 mb-0 d-flex align-items-center gap-4"},ue={class:"card card-flush"},pe={class:"card-body pt-0"},me={class:"table-responsive"},ve={class:"table align-middle table-row-dashed fs-6 gy-4"},fe={class:"fw-semibold text-gray-600"},ge={class:"badge badge-light-success fw-bold"},be={class:"fw-bold text-gray-800"},he={key:0},De={class:"badge badge-light-primary"},we={key:1,class:"text-muted"},ye={key:0,class:"badge badge-light-info"},xe={key:1,class:"text-muted"},ke={class:"text-end"},_e=["onClick"],Ie=["onClick"],Ce={key:0},Me={key:0,class:"modal fade show d-block",style:{"background-color":"rgba(0, 0, 0, 0.5)","z-index":"1060"}},Ae={class:"modal-dialog modal-dialog-centered mw-650px"},Ne={class:"modal-content"},Ue={class:"modal-header"},Se={class:"fw-bold"},Pe={class:"modal-body scroll-y mx-5 mx-xl-15 my-7"},Te={class:"row g-5"},Ve={class:"col-12 col-md-6"},Be={class:"col-12 col-md-6"},$e={class:"col-12 col-md-6"},Ee=["value"],qe={class:"col-12 col-md-6"},Re=["value"],ze={class:"col-12"},Le={class:"col-12"},je={class:"alert bg-light-warning mt-5"},Oe={class:"modal-footer"},Fe=["disabled"],He={key:0,class:"spinner-border spinner-border-sm me-2"},Je="https://backend.cloudfuelstationmis.com/api/records/v1",We={__name:"HRMasterManagementView",setup(Ke){const P=localStorage.getItem("jwt")||"your-jwt-token",d=c([]),w=c([]),r=c(!1),v=c(!1),p=c(!1),a=c({DepartmentName:"",DepartmentCode:"",ParentDepartmentID:null,ManagerUserID:null,Description:"",IsActive:"1"}),f=c(""),M=["Assigning a manager improves responsibility and communication.","Always provide clear codes and names for easier navigation and reporting.","Keep the department tree shallow for agility. Too many parent-child levels can reduce speed of operations.","Inactive departments cannot be assigned to new users or operations.","Consider setting a manager for each department for best accountability."],T=m(()=>M[Math.floor(Math.random()*M.length)]),A=["Most organizations function best with fewer than 5 root (parent-less) departments.","Regularly review and update department managers.","Frequent changes to the hierarchy may confuse staff; maintain stability when possible.","Use department descriptions for internal knowledge sharing.","Avoid code duplication â€” unique codes are critical for integrations and reporting."],V=m(()=>A[Math.floor(Math.random()*A.length)]),B=m(()=>!a.value.DepartmentName||!a.value.DepartmentCode?"Fill in all required fields. Departments without a code or name cause system issues.":a.value.ManagerUserID?a.value.IsActive==="0"?"AI Warning: Inactive departments cannot be assigned new tasks. Only deactivate if you are certain.":"All looks good. Double-check before saving for audit compliance.":"AI Note: Assigning a manager ensures accountability and efficient workflow."),g=async(n,t={})=>{try{const s=await fetch(`${Je}${n}`,{...t,headers:{Authorization:`Bearer ${P}`,"Content-Type":"application/json",...t.headers||{}}});if(!s.ok)throw new Error((await s.json().catch(()=>({}))).message||s.statusText);return await s.json()}catch(s){throw b.fire({title:"API Error",text:s.message,icon:"error",confirmButtonColor:"#f1416c"}),s}},y=async()=>{r.value=!0;try{d.value=(await g("/Departments")).records||[]}finally{r.value=!1}},$=async()=>{r.value=!0;try{w.value=(await g("/users")).records||[]}finally{r.value=!1}};O(()=>{y(),$()});function N(n=null){p.value=!!n,n?a.value={...n}:a.value={DepartmentName:"",DepartmentCode:"",ParentDepartmentID:null,ManagerUserID:null,Description:"",IsActive:"1"},v.value=!0}async function U(){if(!a.value.DepartmentName||!a.value.DepartmentCode){b.fire({title:"Validation Error!",text:"Please fill in all required fields",icon:"warning",confirmButtonColor:"#f1416c"});return}r.value=!0;try{p.value&&a.value.DepartmentID?await g(`/Departments/${a.value.DepartmentID}`,{method:"PATCH",body:JSON.stringify(a.value)}):await g("/Departments",{method:"POST",body:JSON.stringify(a.value)}),v.value=!1,await y(),b.fire({title:"Success!",text:`Department ${p.value?"updated":"created"} successfully`,icon:"success",toast:!0,position:"top-end",timer:3e3,showConfirmButton:!1})}catch{}finally{r.value=!1}}async function E(n){if((await b.fire({title:"Are you sure?",text:`Delete department "${n.DepartmentName}"?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"Cancel",confirmButtonColor:"#f1416c"})).isConfirmed){r.value=!0;try{await g(`/Departments/${n.DepartmentID}`,{method:"DELETE"}),await y(),b.fire({title:"Deleted!",text:"Department has been deleted",icon:"success",toast:!0,position:"top-end",timer:3e3,showConfirmButton:!1})}catch{}finally{r.value=!1}}}const S=m(()=>f.value?d.value.filter(n=>{var t,s;return((t=n.DepartmentName)==null?void 0:t.toLowerCase().includes(f.value.toLowerCase()))||((s=n.DepartmentCode)==null?void 0:s.toLowerCase().includes(f.value.toLowerCase()))}):d.value),h=m(()=>({total:d.value.length,active:d.value.filter(n=>n.IsActive==="1").length,withManagers:d.value.filter(n=>n.ManagerUserID).length,parentDepts:d.value.filter(n=>!n.ParentDepartmentID).length})),q=m(()=>d.value.filter(n=>!p.value||n.DepartmentID!==a.value.DepartmentID));function R(n){const t=w.value.find(s=>s.id==n);return t?t.name:"Unknown"}function z(n){const t=d.value.find(s=>s.DepartmentID==n);return t?t.DepartmentName:"Unknown"}return(n,t)=>(i(),o("div",W,[e("div",K,[e("div",Y,[e("div",null,[t[11]||(t[11]=F('<div class="fs-1 fw-bold text-dark d-flex align-items-center mb-1" data-v-92fc2652><i class="ki-duotone ki-organization fs-2hx text-success me-3" data-v-92fc2652><span class="path1" data-v-92fc2652></span><span class="path2" data-v-92fc2652></span><span class="path3" data-v-92fc2652></span></i> Departments Management </div><div class="fs-5 text-gray-600 mb-2" data-v-92fc2652> Manage and optimize your organizational structure. </div>',2)),e("div",G,[t[10]||(t[10]=e("i",{class:"ki-duotone ki-brain fs-2 me-2"},[e("span",{class:"path1"}),e("span",{class:"path2"})],-1)),e("span",null,l(T.value),1)])]),e("div",null,[e("button",{onClick:t[0]||(t[0]=s=>N()),class:"btn btn-light-success btn-lg fw-bold"},t[12]||(t[12]=[e("i",{class:"ki-duotone ki-plus fs-2"},[e("span",{class:"path1"}),e("span",{class:"path2"})],-1),k(" New Department ")]))])])]),e("div",Q,[e("div",X,[e("div",Z,[e("div",ee,[t[13]||(t[13]=e("i",{class:"ki-duotone ki-magnifier fs-3 position-absolute ms-4"},[e("span",{class:"path1"}),e("span",{class:"path2"})],-1)),u(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>f.value=s),type:"text",class:"form-control form-control-solid w-250px ps-12",placeholder:"Search departments by name or code..."},null,512),[[D,f.value]])])]),e("div",te,[e("div",se,[e("div",ae,l(h.value.total),1),t[14]||(t[14]=e("div",{class:"fs-8 text-gray-600"},"Total",-1))]),e("div",ne,[e("div",le,l(h.value.active),1),t[15]||(t[15]=e("div",{class:"fs-8 text-gray-600"},"Active",-1))]),e("div",oe,[e("div",ie,l(h.value.withManagers),1),t[16]||(t[16]=e("div",{class:"fs-8 text-gray-600"},"With Managers",-1))]),e("div",re,[e("div",de,l(h.value.parentDepts),1),t[17]||(t[17]=e("div",{class:"fs-8 text-gray-600"},"Root",-1))])])]),e("div",ce,[t[19]||(t[19]=e("i",{class:"ki-duotone ki-light-bulb fs-2hx text-info"},[e("span",{class:"path1"}),e("span",{class:"path2"})],-1)),e("div",null,[t[18]||(t[18]=e("span",{class:"fw-bold"},"AI Suggestion:",-1)),e("span",null,l(V.value),1)])])]),e("div",ue,[e("div",pe,[e("div",me,[e("table",ve,[t[24]||(t[24]=e("thead",null,[e("tr",{class:"text-start text-gray-500 fw-bold fs-7 text-uppercase gs-0"},[e("th",null,"Code"),e("th",null,"Name"),e("th",null,"Manager"),e("th",null,"Parent Dept"),e("th",null,"Status"),e("th",{class:"text-end"},"Actions")])],-1)),e("tbody",fe,[(i(!0),o(_,null,I(S.value,s=>(i(),o("tr",{key:s.DepartmentID},[e("td",null,[e("span",ge,l(s.DepartmentCode),1)]),e("td",be,l(s.DepartmentName),1),e("td",null,[s.ManagerUserID?(i(),o("span",he,[e("span",De,[t[20]||(t[20]=e("i",{class:"ki-duotone ki-user fs-5 me-1"},[e("span",{class:"path1"}),e("span",{class:"path2"})],-1)),k(" "+l(R(s.ManagerUserID)),1)])])):(i(),o("span",we,"No Manager"))]),e("td",null,[s.ParentDepartmentID?(i(),o("span",ye,l(z(s.ParentDepartmentID)),1)):(i(),o("span",xe,"Root"))]),e("td",null,[e("span",{class:J(s.IsActive==="1"?"badge badge-light-success":"badge badge-light-danger")},l(s.IsActive==="1"?"Active":"Inactive"),3)]),e("td",ke,[e("button",{onClick:L=>N(s),class:"btn btn-icon btn-light-primary btn-sm me-2"},t[21]||(t[21]=[e("i",{class:"ki-duotone ki-pencil fs-5"},[e("span",{class:"path1"}),e("span",{class:"path2"})],-1)]),8,_e),e("button",{onClick:L=>E(s),class:"btn btn-icon btn-light-danger btn-sm"},t[22]||(t[22]=[e("i",{class:"ki-duotone ki-trash fs-5"},[e("span",{class:"path1"}),e("span",{class:"path2"}),e("span",{class:"path3"})],-1)]),8,Ie)])]))),128)),S.value.length===0?(i(),o("tr",Ce,t[23]||(t[23]=[e("td",{colspan:"6",class:"text-center text-muted py-10"},[e("i",{class:"ki-duotone ki-search-list fs-3x text-gray-300 mb-3"},[e("span",{class:"path1"}),e("span",{class:"path2"}),e("span",{class:"path3"})]),e("div",null,"No departments found")],-1)]))):x("",!0)])])])])]),v.value?(i(),o("div",Me,[e("div",Ae,[e("div",Ne,[e("div",Ue,[e("h2",Se,l(p.value?"Edit":"New")+" Department",1),e("button",{onClick:t[2]||(t[2]=s=>v.value=!1),class:"btn btn-icon btn-sm btn-active-light-primary"},t[25]||(t[25]=[e("i",{class:"ki-duotone ki-cross fs-1"},[e("span",{class:"path1"}),e("span",{class:"path2"})],-1)]))]),e("div",Pe,[e("form",{onSubmit:H(U,["prevent"]),novalidate:""},[e("div",Te,[e("div",Ve,[t[26]||(t[26]=e("label",{class:"required form-label"},"Department Code",-1)),u(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>a.value.DepartmentCode=s),type:"text",class:"form-control form-control-lg",required:""},null,512),[[D,a.value.DepartmentCode]])]),e("div",Be,[t[27]||(t[27]=e("label",{class:"required form-label"},"Department Name",-1)),u(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>a.value.DepartmentName=s),type:"text",class:"form-control form-control-lg",required:""},null,512),[[D,a.value.DepartmentName]])]),e("div",$e,[t[29]||(t[29]=e("label",{class:"form-label"},"Parent Department",-1)),u(e("select",{"onUpdate:modelValue":t[5]||(t[5]=s=>a.value.ParentDepartmentID=s),class:"form-select form-select-lg"},[t[28]||(t[28]=e("option",{value:null},"None (Root Department)",-1)),(i(!0),o(_,null,I(q.value,s=>(i(),o("option",{key:s.DepartmentID,value:s.DepartmentID},l(s.DepartmentName),9,Ee))),128))],512),[[C,a.value.ParentDepartmentID]])]),e("div",qe,[t[31]||(t[31]=e("label",{class:"form-label"},"Department Manager",-1)),u(e("select",{"onUpdate:modelValue":t[6]||(t[6]=s=>a.value.ManagerUserID=s),class:"form-select form-select-lg"},[t[30]||(t[30]=e("option",{value:null},"No Manager",-1)),(i(!0),o(_,null,I(w.value,s=>(i(),o("option",{key:s.id,value:s.id},l(s.name),9,Re))),128))],512),[[C,a.value.ManagerUserID]])]),e("div",ze,[t[33]||(t[33]=e("label",{class:"form-label"},"Status",-1)),u(e("select",{"onUpdate:modelValue":t[7]||(t[7]=s=>a.value.IsActive=s),class:"form-select form-select-lg"},t[32]||(t[32]=[e("option",{value:"1"},"Active",-1),e("option",{value:"0"},"Inactive",-1)]),512),[[C,a.value.IsActive]])]),e("div",Le,[t[34]||(t[34]=e("label",{class:"form-label"},"Description",-1)),u(e("textarea",{"onUpdate:modelValue":t[8]||(t[8]=s=>a.value.Description=s),class:"form-control form-control-lg",rows:"3"},null,512),[[D,a.value.Description]])])])],32),e("div",je,[t[35]||(t[35]=e("i",{class:"ki-duotone ki-alert-triangle fs-2 text-warning me-3"},[e("span",{class:"path1"}),e("span",{class:"path2"})],-1)),e("span",null,l(B.value),1)])]),e("div",Oe,[e("button",{onClick:t[9]||(t[9]=s=>v.value=!1),class:"btn btn-light me-3"},"Cancel"),e("button",{onClick:U,class:"btn btn-success",disabled:r.value},[r.value?(i(),o("span",He)):x("",!0),k(" "+l(p.value?"Update":"Create")+" Department ",1)],8,Fe)])])])])):x("",!0)]))}},Ge=j(We,[["__scopeId","data-v-92fc2652"]]);export{Ge as default};
