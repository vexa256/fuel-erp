import { _ as rt, r as u, a as ct, c as ut, o as pt, q as bt, d as a, e as t, g, f as q, i as c, w as _, j as X, F as x, k, s as K, t as o, v as Q, S as b, p as i, l as ft, h as W } from "./index-Fk_fMhvq.js"; import { a as m } from "./index-Dq7h7Pqt.js"; const vt = { class: "d-flex flex-column gap-8 p-6 bg-light rounded-4" }, gt = { class: "card card-flush bg-light-primary shadow-lg mb-5 rounded-4 border-0 position-relative" }, mt = { class: "card-header border-0 py-4 px-4 d-flex align-items-center justify-content-between bg-gradient-primary rounded-top-4" }, ht = { key: 0, class: "modal fade show d-block", tabindex: "-1", style: { background: "rgba(0, 0, 0, 0.25)", "z-index": "1055" }, "aria-modal": "true", role: "dialog" }, yt = { class: "modal-dialog modal-dialog-centered" }, wt = { class: "modal-content rounded-4 shadow-lg border-0 p-0 overflow-hidden" }, xt = { class: "modal-header bg-light-warning rounded-top-4 py-4 px-4 d-flex align-items-center gap-3" }, kt = { class: "modal-body p-5 bg-white text-gray-900 fs-5" }, St = { class: "card card-flush border-0 shadow-sm bg-light-info mb-3" }, Ct = { class: "card-body" }, At = ["disabled"], Dt = ["value"], It = { key: 0, class: "text-danger mt-2 fs-6" }, _t = { key: 0, class: "card card-flush bg-white shadow-lg mb-2" }, $t = { class: "card-header py-4 d-flex flex-wrap align-items-center gap-3 justify-content-between" }, Tt = { class: "card-body d-flex flex-column gap-4" }, Nt = { key: 0, class: "d-flex justify-content-center py-8" }, Bt = { key: 1, class: "text-center fs-5 text-gray-600" }, Et = { key: 2, class: "d-flex flex-wrap gap-3" }, Lt = { class: "fs-5 fw-bold text-dark d-flex align-items-center gap-1" }, Pt = { class: "fs-7 text-gray-700" }, Ut = { class: "fs-8 text-gray-500" }, qt = ["onClick"], Ot = { key: 1, class: "offcanvas offcanvas-end show bg-white", tabindex: "-1", style: { visibility: "visible" } }, jt = { class: "offcanvas-header border-bottom py-4" }, zt = { class: "offcanvas-body" }, Mt = { key: 0, class: "text-center py-5" }, Rt = { key: 1 }, Vt = { class: "d-flex flex-column gap-2 mb-3" }, Ft = ["id", "value"], Gt = ["for"], Ht = { class: "fs-8 text-gray-500 ms-1" }, Jt = ["disabled"], Wt = { key: 0, class: "spinner-border spinner-border-sm me-2" }, Xt = { key: 2, class: "d-flex flex-wrap gap-5 justify-content-center mb-2" }, Kt = { class: "card-body d-flex flex-column align-items-start gap-1" }, Qt = { class: "fw-bold fs-2 d-flex align-items-center gap-2 text-dark" }, Yt = { key: 0, class: "path3" }, Zt = { class: "fs-6 text-gray-700" }, ts = { class: "card-footer bg-transparent pt-0" }, ss = { key: 3, class: "card card-flush bg-white shadow-lg mb-2" }, es = { class: "card-header align-items-center gap-4" }, as = { class: "card-title fw-bold fs-2 text-gray-800" }, is = ["disabled"], ls = { class: "card-body p-2 d-flex flex-column gap-5" }, ns = { key: 0, class: "d-flex justify-content-center py-8" }, os = { key: 1, class: "text-center fs-5 text-gray-600" }, ds = { key: 2, class: "d-flex flex-column gap-4" }, rs = { class: "fs-4 fw-bold text-dark d-flex align-items-center gap-1" }, cs = { class: "fs-7 text-gray-700" }, us = { class: "fs-7 text-gray-700" }, ps = ["onClick"], bs = ["onClick"], fs = { key: 4, class: "offcanvas offcanvas-end show bg-white", tabindex: "-1", style: { visibility: "visible" } }, vs = { class: "offcanvas-header border-bottom py-4" }, gs = { class: "offcanvas-title fw-bold fs-2 text-primary" }, ms = { class: "offcanvas-body" }, hs = ["value"], ys = { key: 0, class: "text-danger fs-7 mt-1" }, ws = { class: "mt-2" }, xs = ["disabled"], ks = { key: 0, class: "spinner-border spinner-border-sm me-2" }, Ss = { key: 5, class: "card card-flush border-0 shadow-lg bg-white mt-2" }, Cs = { class: "card-header bg-light py-4 d-flex justify-content-between align-items-center" }, As = { class: "card-title fw-bold fs-2 text-primary d-flex align-items-center gap-2" }, Ds = { class: "card-body" }, Is = { class: "row g-4 mb-2" }, _s = { class: "col-6" }, $s = { class: "fs-4 fw-bold" }, Ts = { class: "col-6" }, Ns = { class: "fs-4 fw-bold" }, Bs = { class: "col-6" }, Es = { class: "fs-4 fw-bold" }, Ls = { class: "col-6" }, Ps = { class: "fs-4 fw-bold" }, Us = { key: 0, class: "text-center py-4" }, qs = { key: 1, class: "text-center fs-7 text-gray-600" }, Os = { key: 2, class: "d-flex flex-column gap-3" }, js = { class: "fs-7" }, zs = { class: "text-primary" }, Ms = { class: "text-gray-700" }, Rs = { class: "fw-bold fs-6 text-dark" }, Vs = { class: "text-gray-600 fs-8" }, h = "https://backend.cloudfuelstationmis.com/api/records/v1", Fs = { __name: "CreditAccountManagementHub", setup(Gs) { const f = localStorage.getItem("jwt") || "", $ = u(!1), O = u([]), j = u(!1), r = u(""), y = u([]), T = u([]), z = u(!1), N = u(!1), S = u([]), B = u(!1), M = u(!1), v = u([]), R = u(!1), V = u(!1), E = u(!1), p = ct({ SupplierID: "", CreditLimit: "", PaymentTermsDays: 30 }), F = u(null), C = u(null), A = u(!1), L = u([]), G = u(!1), Y = ut(() => { const l = v.value.length, s = v.value.reduce((d, J) => d + Number(J.CurrentBalance || 0), 0), n = v.value.reduce((d, J) => d + Number(J.CreditLimit || 0), 0), e = v.value.filter(d => d.CreditStatus !== "Normal").length; return [{ title: "Credit Accounts", value: l, icon: "ki-duotone ki-users fs-2", badge: l > 0 ? "Active" : "None", badgeClass: l > 0 ? "badge-light-success" : "badge-light-warning", iconPaths: 2 }, { title: "Total Owed", value: w(s), icon: "ki-duotone ki-bank fs-2", badge: "Outstanding", badgeClass: "badge-light-warning", iconPaths: 2 }, { title: "Total Credit Limit", value: w(n), icon: "ki-duotone ki-graph-up fs-2", badge: "Credit Cap", badgeClass: "badge-light-primary", iconPaths: 2 }, { title: "Accounts at Risk", value: e, icon: "ki-duotone ki-shield-alert fs-2", badge: e > 0 ? "Risk" : "Normal", badgeClass: e > 0 ? "badge-light-danger" : "badge-light-success", iconPaths: 2 }] }), w = l => "UGX " + Number(l || 0).toLocaleString(void 0, { minimumFractionDigits: 2 }), Z = l => ({ "Over Limit": "badge-light-danger", "Near Limit": "badge-light-warning", Normal: "badge-light-success" })[l] || "badge-light-secondary", tt = async () => { j.value = !0; try { const { data: l } = await m.get(`${h}/Stations`, { headers: { Authorization: `Bearer ${f}` } }); O.value = l.records || [] } catch { O.value = [], b.fire({ title: "Error!", text: "Failed to load stations.", icon: "error" }) } finally { j.value = !1 } }, P = async () => { if (!r.value) return y.value = []; M.value = !0; try { const { data: l } = await m.get(`${h}/SupplierStations?StationID=${r.value}`, { headers: { Authorization: `Bearer ${f}` } }), s = (l.records || []).map(e => e.SupplierID); if (s.length === 0) { y.value = []; return } const { data: n } = await m.get(`${h}/Suppliers?SupplierID=in.(${s.join(",")})`, { headers: { Authorization: `Bearer ${f}` } }); y.value = n.records || [] } catch { y.value = [] } finally { M.value = !1 } }, U = async () => { z.value = !0; try { const { data: l } = await m.get(`${h}/Suppliers`, { headers: { Authorization: `Bearer ${f}` } }); T.value = (l.records || []).filter(s => !y.value.some(n => n.SupplierID === s.SupplierID)) } catch { T.value = [] } finally { z.value = !1 } }, st = async () => { var l, s; if (!(S.value.length === 0 || !r.value)) { B.value = !0; try { for (const n of S.value) await m.post(`${h}/SupplierStations`, { SupplierID: n, StationID: r.value }, { headers: { Authorization: `Bearer ${f}` } }), await I("CREATE", "SupplierStations", null, { SupplierID: n, StationID: r.value }); b.fire({ title: "Assigned", text: "Suppliers assigned to station.", icon: "success", toast: !0, timer: 2e3, showConfirmButton: !1, position: "top-end" }), S.value = [], N.value = !1, await P(), await U() } catch (n) { b.fire({ title: "Error", text: ((s = (l = n == null ? void 0 : n.response) == null ? void 0 : l.data) == null ? void 0 : s.message) || "Assignment failed", icon: "error" }) } finally { B.value = !1 } } }, et = async l => { var n, e; if ((await b.fire({ title: "Unassign Supplier?", text: "This will remove the supplier from this station.", icon: "warning", showCancelButton: !0, confirmButtonColor: "#f1416c" })).isConfirmed) try { await m.delete(`${h}/SupplierStations/${l}`, { headers: { Authorization: `Bearer ${f}` }, params: { StationID: r.value } }), await I("DELETE", "SupplierStations", l, { StationID: r.value }), b.fire({ title: "Removed", text: "Supplier unassigned.", icon: "success", toast: !0, timer: 2e3, showConfirmButton: !1, position: "top-end" }), await P(), await U(), await D() } catch (d) { b.fire({ title: "Error", text: ((e = (n = d == null ? void 0 : d.response) == null ? void 0 : n.data) == null ? void 0 : e.message) || "Unassign failed.", icon: "error" }) } }, D = async () => { if (!r.value) return v.value = []; R.value = !0; try { const { data: l } = await m.get(`${h}/SupplierCreditAccounts?StationID=${r.value}`, { headers: { Authorization: `Bearer ${f}` } }); v.value = l.records || [] } catch { v.value = [], b.fire({ title: "Error!", text: "Failed to fetch credit accounts.", icon: "error" }) } finally { R.value = !1 } }, at = async l => { C.value = l, A.value = !0, it(l.SupplierID) }, it = async l => { G.value = !0; try { const { data: s } = await m.get(`${h}/SupplierCreditTransactions?SupplierID=${l}&StationID=${r.value}&_sort=-CreatedAt`, { headers: { Authorization: `Bearer ${f}` } }); L.value = s.records || [] } catch { L.value = [] } finally { G.value = !1 } }, H = () => { V.value = !1, F.value = null, p.SupplierID = "", p.CreditLimit = "", p.PaymentTermsDays = 30 }, lt = async () => { var l, s; if (!p.SupplierID || !p.CreditLimit || !r.value) { b.fire({ title: "Missing Fields", text: "Please fill all required fields.", icon: "error" }); return } E.value = !0; try { const n = v.value.find(d => d.SupplierID === p.SupplierID && d.StationID == r.value), e = { SupplierID: p.SupplierID, StationID: r.value, CreditLimit: p.CreditLimit, PaymentTermsDays: p.PaymentTermsDays, IsActive: "1" }; n ? (await m.patch(`${h}/SupplierCreditAccounts/${n.CreditAccountID}`, e, { headers: { Authorization: `Bearer ${f}` } }), await I("UPDATE", "SupplierCreditAccounts", n.CreditAccountID, e), b.fire({ title: "Updated", text: "Credit account updated.", icon: "success", toast: !0, timer: 2e3, showConfirmButton: !1, position: "top-end" })) : (await m.post(`${h}/SupplierCreditAccounts`, e, { headers: { Authorization: `Bearer ${f}` } }), await I("CREATE", "SupplierCreditAccounts", null, e), b.fire({ title: "Success", text: "Credit account created!", icon: "success", toast: !0, timer: 2e3, showConfirmButton: !1, position: "top-end" })), await D(), H() } catch (n) { b.fire({ title: "Error", text: ((s = (l = n == null ? void 0 : n.response) == null ? void 0 : l.data) == null ? void 0 : s.message) || "Operation failed", icon: "error" }) } finally { E.value = !1 } }, nt = () => { H(), A.value = !1, D(), P(), U() }, ot = async l => { var n, e; if ((await b.fire({ title: "Delete Account?", text: "Are you sure? This cannot be undone.", icon: "warning", showCancelButton: !0, confirmButtonColor: "#f1416c" })).isConfirmed) try { await m.delete(`${h}/SupplierCreditAccounts/${l}`, { headers: { Authorization: `Bearer ${f}` } }), await I("DELETE", "SupplierCreditAccounts", l, {}), b.fire({ title: "Deleted", text: "Credit account removed.", icon: "success", toast: !0, timer: 2e3, showConfirmButton: !1, position: "top-end" }), await D() } catch (d) { b.fire({ title: "Error", text: ((e = (n = d == null ? void 0 : d.response) == null ? void 0 : n.data) == null ? void 0 : e.message) || "Delete failed.", icon: "error" }) } }, I = async (l, s, n, e) => { try { await m.post(`${h}/AuditLogs`, { StationID: r.value, UserID: dt(), Action: l, TableName: s, RecordID: n, Changes: JSON.stringify(e), IPAddress: "", LogTimestamp: new Date().toISOString() }, { headers: { Authorization: `Bearer ${f}` } }) } catch { } }, dt = () => { try { return JSON.parse(localStorage.getItem("user") || "{}").id || null } catch { return null } }; return pt(() => { tt() }), bt(r, () => { r.value ? (D(), P(), U()) : (v.value = [], y.value = [], T.value = [], A.value = !1) }), (l, s) => { var n; return i(), a("div", vt, [t("div", gt, [t("div", mt, [s[13] || (s[13] = q('<h2 class="card-title fw-bolder fs-1 d-flex align-items-center text-primary fw-bold gap-3 text-white" data-v-91dd3bbc><i class="ki-duotone ki-help-circle fs-1 t text-warning" data-v-91dd3bbc><span class="path1" data-v-91dd3bbc></span><span class="path2" data-v-91dd3bbc></span></i><span class="d-block text-primary fw-bold" data-v-91dd3bbc>Credit Account Workflow</span></h2>', 1)), t("button", { class: "btn btn-light-warning btn-icon btn-lg shadow-sm", onClick: s[0] || (s[0] = e => $.value = !0), "aria-label": "More info", style: { "min-width": "44px", "min-height": "44px" } }, s[12] || (s[12] = [t("i", { class: "ki-duotone ki-information-5 fs-2 text-warning" }, [t("span", { class: "path1" }), t("span", { class: "path2" })], -1)]))]), s[18] || (s[18] = q('<div class="card-body px-4 pt-4 pb-2 fs-5 bg-light-primary rounded-bottom-4" data-v-91dd3bbc><ul class="ps-2 mb-3 fs-6" data-v-91dd3bbc><li class="mb-2 d-flex align-items-start gap-2" data-v-91dd3bbc><span class="badge badge-light-warning rounded-pill fw-bold fs-8 px-3 py-1 mt-1" data-v-91dd3bbc>1</span><span class="text-gray-900" data-v-91dd3bbc>Select your fuel station to unlock supplier and credit features.</span></li><li class="mb-2 d-flex align-items-start gap-2" data-v-91dd3bbc><span class="badge badge-light-success rounded-pill fw-bold fs-8 px-3 py-1 mt-1" data-v-91dd3bbc>2</span><span data-v-91dd3bbc> Assign suppliers <span class="badge badge-light-warning ms-1 fs-9" data-v-91dd3bbc>Station Relationship</span> — each supplier must be linked to a station before credit is granted. </span></li><li class="mb-2 d-flex align-items-start gap-2" data-v-91dd3bbc><span class="badge badge-light-info rounded-pill fw-bold fs-8 px-3 py-1 mt-1" data-v-91dd3bbc>3</span><span data-v-91dd3bbc> Create/manage <span class="badge badge-light-info" data-v-91dd3bbc>Credit Accounts</span> for assigned suppliers. Each credit account ties to one supplier and one station only. </span></li><li class="d-flex align-items-start gap-2" data-v-91dd3bbc><span class="badge badge-light-primary rounded-pill fw-bold fs-8 px-3 py-1 mt-1" data-v-91dd3bbc>Pro</span><span data-v-91dd3bbc> Instantly link/unlink suppliers with the <span class="fw-bold text-primary" data-v-91dd3bbc>Relationship Manager</span> below.<br data-v-91dd3bbc><span class="text-gray-700" data-v-91dd3bbc>All changes are logged for compliance and full transparency.</span></span></li></ul><div class="d-flex flex-wrap gap-3 align-items-center mt-3" data-v-91dd3bbc><span class="badge badge-light fs-7 text-primary px-4 py-2 rounded-pill shadow-sm" data-v-91dd3bbc><i class="ki-duotone ki-touch fs-2 me-2 text-primary" data-v-91dd3bbc><span class="path1" data-v-91dd3bbc></span><span class="path2" data-v-91dd3bbc></span></i> Tap a supplier card for relationship &amp; account details </span><span class="badge badge-light-danger fs-7 px-4 py-2 rounded-pill shadow-sm" data-v-91dd3bbc><i class="ki-duotone ki-alert-triangle fs-2 me-2 text-danger" data-v-91dd3bbc><span class="path1" data-v-91dd3bbc></span><span class="path2" data-v-91dd3bbc></span></i> One active credit account per supplier per station </span><span class="badge badge-light-success fs-7 px-4 py-2 rounded-pill shadow-sm" data-v-91dd3bbc><i class="ki-duotone ki-shield-check fs-2 me-2 text-success" data-v-91dd3bbc><span class="path1" data-v-91dd3bbc></span><span class="path2" data-v-91dd3bbc></span></i> Full audit trail for every action </span></div></div>', 1)), $.value ? (i(), a("div", ht, [t("div", yt, [t("div", wt, [t("div", xt, [s[14] || (s[14] = t("i", { class: "ki-duotone ki-credit-card fs-2 text-warning" }, [t("span", { class: "path1" }), t("span", { class: "path2" })], -1)), s[15] || (s[15] = t("h5", { class: "modal-title fw-bold fs-2 text-warning mb-0" }, " About Credit Accounts & Relationships ", -1)), t("button", { type: "button", class: "btn-close ms-auto", "aria-label": "Close", style: { filter: "invert(0.7)" }, onClick: s[1] || (s[1] = e => $.value = !1) })]), t("div", kt, [s[17] || (s[17] = q('<div class="mb-3" data-v-91dd3bbc><p data-v-91dd3bbc><b data-v-91dd3bbc>Credit Accounts</b> power supplier management.<br data-v-91dd3bbc> Each <span class="badge badge-light-info" data-v-91dd3bbc>Credit Account</span> links a <b data-v-91dd3bbc>Supplier</b> to a <b data-v-91dd3bbc>Station</b> with agreed credit limits and payment terms. </p><ul class="mb-3 ps-3" data-v-91dd3bbc><li data-v-91dd3bbc><b data-v-91dd3bbc>One supplier, many stations:</b> Each station can have unique credit terms for the same supplier. </li><li data-v-91dd3bbc><b data-v-91dd3bbc>Full traceability:</b> All actions are recorded for compliance and auditing. </li><li data-v-91dd3bbc><b data-v-91dd3bbc>ERP-wide impact:</b> Managing credit accounts controls supply on credit, cash flow, and risk. </li><li data-v-91dd3bbc><b data-v-91dd3bbc>Cannot duplicate:</b> Only one active credit account per supplier per station is allowed. </li></ul><div class="alert alert-light-info rounded-3 fs-6 p-3 d-flex align-items-center gap-3 mt-4" data-v-91dd3bbc><i class="ki-duotone ki-information fs-2 text-info" data-v-91dd3bbc><span class="path1" data-v-91dd3bbc></span><span class="path2" data-v-91dd3bbc></span></i><span data-v-91dd3bbc><b data-v-91dd3bbc>Best Practice:</b> Always link suppliers to stations before creating a credit account. This enables precise control and clear supplier accountability for every station. </span></div></div>', 1)), t("button", { class: "btn btn-light-primary btn-lg w-100 fw-bold rounded-pill mt-2", onClick: s[2] || (s[2] = e => $.value = !1), style: { "min-height": "48px" } }, s[16] || (s[16] = [t("i", { class: "ki-duotone ki-check-square fs-2 me-2 text-primary" }, [t("span", { class: "path1" }), t("span", { class: "path2" })], -1), c(" Got it, let's manage credit! ")]))])])])])) : g("", !0)]), t("div", St, [s[20] || (s[20] = q('<div class="card-header py-4" data-v-91dd3bbc><h2 class="card-title fs-2 fw-bold text-primary d-flex align-items-center gap-2" data-v-91dd3bbc><i class="ki-duotone ki-map-pin fs-1" data-v-91dd3bbc><span class="path1" data-v-91dd3bbc></span><span class="path2" data-v-91dd3bbc></span></i> Select Station </h2></div>', 1)), t("div", Ct, [_(t("select", { class: "form-select form-select-lg", "onUpdate:modelValue": s[3] || (s[3] = e => r.value = e), onChange: nt, disabled: j.value }, [s[19] || (s[19] = t("option", { value: "" }, "-- Choose a Station --", -1)), (i(!0), a(x, null, k(O.value, e => (i(), a("option", { key: e.StationID, value: e.StationID }, o(e.StationName), 9, Dt))), 128))], 40, At), [[X, r.value]]), r.value ? g("", !0) : (i(), a("div", It, " Please select a station to begin. "))])]), r.value ? (i(), a("div", _t, [t("div", $t, [s[22] || (s[22] = t("h3", { class: "card-title fw-bold fs-2 text-gray-800" }, [t("i", { class: "ki-duotone ki-link fs-1 me-2" }, [t("span", { class: "path1" }), t("span", { class: "path2" })]), c(" Station–Supplier Relationship Manager ")], -1)), t("button", { class: "btn btn-light-primary btn-lg fw-bold", onClick: s[4] || (s[4] = e => N.value = !0) }, s[21] || (s[21] = [t("i", { class: "ki-duotone ki-plus-square fs-2 me-1" }, [t("span", { class: "path1" }), t("span", { class: "path2" })], -1), c(" Assign Suppliers ")]))]), t("div", Tt, [M.value ? (i(), a("div", Nt, s[23] || (s[23] = [t("span", { class: "spinner-border text-primary" }, null, -1)]))) : y.value.length === 0 ? (i(), a("div", Bt, s[24] || (s[24] = [c(" No suppliers assigned to this station."), t("br", null, null, -1), t("span", { class: "fs-7 text-muted" }, [c("Use "), t("b", null, "Assign Suppliers"), c(" to link suppliers to this station.")], -1)]))) : (i(), a("div", Et, [(i(!0), a(x, null, k(y.value, e => (i(), a("div", { key: e.SupplierID, class: "card bg-light-success border-0 rounded-3 shadow-sm p-3 d-flex flex-row align-items-center justify-content-between min-w-200px flex-grow-1" }, [t("div", null, [t("div", Lt, [s[25] || (s[25] = t("i", { class: "ki-duotone ki-user-square fs-2 me-2" }, [t("span", { class: "path1" }), t("span", { class: "path2" })], -1)), c(" " + o(e.Name) + " ", 1), s[26] || (s[26] = t("span", { class: "badge badge-light-success ms-2" }, "Assigned", -1))]), t("div", Pt, "TIN: " + o(e.TaxIdentificationNumber || "N/A"), 1), t("div", Ut, "Email: " + o(e.Email || "N/A"), 1)]), t("div", null, [t("button", { class: "btn btn-outline-danger btn-icon btn-lg", title: "Unassign Supplier", onClick: d => et(e.SupplierID) }, s[27] || (s[27] = [t("i", { class: "ki-duotone ki-unlink fs-2" }, [t("span", { class: "path1" }), t("span", { class: "path2" })], -1)]), 8, qt)])]))), 128))]))])])) : g("", !0), N.value ? (i(), a("div", Ot, [t("div", jt, [s[29] || (s[29] = t("h4", { class: "offcanvas-title fw-bold fs-2 text-primary" }, [t("i", { class: "ki-duotone ki-link-square fs-2" }, [t("span", { class: "path1" }), t("span", { class: "path2" })]), c(" Assign Suppliers to Station ")], -1)), t("button", { class: "btn btn-light btn-icon", onClick: s[5] || (s[5] = e => N.value = !1) }, s[28] || (s[28] = [t("i", { class: "ki-duotone ki-cross fs-2" }, [t("span", { class: "path1" }), t("span", { class: "path2" })], -1)]))]), t("div", zt, [z.value ? (i(), a("div", Mt, s[30] || (s[30] = [t("span", { class: "spinner-border text-primary" }, null, -1)]))) : (i(), a("div", Rt, [t("form", { onSubmit: K(st, ["prevent"]), class: "d-flex flex-column gap-3" }, [s[33] || (s[33] = t("label", { class: "fw-bold fs-6 mb-1" }, "Select suppliers to assign:", -1)), t("div", Vt, [(i(!0), a(x, null, k(T.value, e => (i(), a("div", { key: e.SupplierID, class: "form-check" }, [_(t("input", { type: "checkbox", class: "form-check-input", id: "sup-" + e.SupplierID, "onUpdate:modelValue": s[6] || (s[6] = d => S.value = d), value: e.SupplierID }, null, 8, Ft), [[ft, S.value]]), t("label", { class: "form-check-label", for: "sup-" + e.SupplierID }, [c(o(e.Name) + " ", 1), t("span", Ht, o(e.TaxIdentificationNumber), 1)], 8, Gt)]))), 128))]), t("button", { class: "btn btn-light-primary btn-lg fw-bold", disabled: S.value.length === 0 || B.value }, [B.value ? (i(), a("span", Wt)) : g("", !0), s[31] || (s[31] = t("i", { class: "ki-duotone ki-link fs-2 me-2" }, [t("span", { class: "path1" }), t("span", { class: "path2" })], -1)), s[32] || (s[32] = c(" Assign Selected "))], 8, Jt)], 32)]))])])) : g("", !0), r.value ? (i(), a("div", Xt, [(i(!0), a(x, null, k(Y.value, e => (i(), a("div", { class: "card card-flush bg-light-primary shadow min-w-180px min-h-140px flex-grow-1 d-flex flex-column justify-content-between", key: e.title }, [t("div", Kt, [t("div", Qt, [t("i", { class: W([e.icon, "me-2"]) }, [s[34] || (s[34] = t("span", { class: "path1" }, null, -1)), s[35] || (s[35] = t("span", { class: "path2" }, null, -1)), e.iconPaths > 2 ? (i(), a("span", Yt)) : g("", !0)], 2), c(" " + o(e.value), 1)]), t("div", Zt, o(e.title), 1)]), t("div", ts, [t("span", { class: W([e.badgeClass, "badge fw-semibold px-4 py-2 fs-8"]) }, o(e.badge), 3)])]))), 128))])) : g("", !0), r.value ? (i(), a("div", ss, [t("div", es, [t("h3", as, [s[36] || (s[36] = t("i", { class: "ki-duotone ki-credit-card fs-1 me-2" }, [t("span", { class: "path1" }), t("span", { class: "path2" })], -1)), c(" Credit Accounts (" + o(v.value.length) + ") ", 1)]), t("button", { class: "btn btn-light-success btn-lg fw-bold", onClick: s[7] || (s[7] = e => V.value = !0), disabled: y.value.length === 0 }, s[37] || (s[37] = [t("i", { class: "ki-duotone ki-plus fs-2 me-1" }, [t("span", { class: "path1" }), t("span", { class: "path2" })], -1), c(" New Credit Account ")]), 8, is)]), t("div", ls, [R.value ? (i(), a("div", ns, s[38] || (s[38] = [t("span", { class: "spinner-border text-success" }, null, -1)]))) : v.value.length === 0 ? (i(), a("div", os, " No credit accounts for this station yet. ")) : (i(), a("div", ds, [(i(!0), a(x, null, k(v.value, e => (i(), a("div", { key: e.CreditAccountID, class: "card bg-light-warning border-0 rounded-3 shadow-sm p-3 d-flex flex-row align-items-center justify-content-between" }, [t("div", null, [t("div", rs, [s[39] || (s[39] = t("i", { class: "ki-duotone ki-user-square fs-2 me-2" }, [t("span", { class: "path1" }), t("span", { class: "path2" })], -1)), c(" " + o(e.SupplierName) + " ", 1), t("span", { class: W(["badge", Z(e.CreditStatus), "ms-2"]) }, o(e.CreditStatus), 3)]), t("div", cs, [s[40] || (s[40] = c(" Limit: ")), t("b", null, o(w(e.CreditLimit)), 1), s[41] || (s[41] = c(" • Owing: ")), t("b", null, o(w(e.CurrentBalance)), 1)]), t("div", us, "Terms: " + o(e.PaymentTermsDays) + " days", 1)]), t("div", null, [t("button", { class: "btn btn-outline-primary btn-icon btn-lg me-1", onClick: d => at(e), title: "View Details" }, s[42] || (s[42] = [t("i", { class: "ki-duotone ki-eye fs-2" }, [t("span", { class: "path1" }), t("span", { class: "path2" })], -1)]), 8, ps), t("button", { class: "btn btn-outline-danger btn-icon btn-lg", onClick: d => ot(e.CreditAccountID), title: "Delete Account" }, s[43] || (s[43] = [t("i", { class: "ki-duotone ki-trash fs-2" }, [t("span", { class: "path1" }), t("span", { class: "path2" })], -1)]), 8, bs)])]))), 128))]))])])) : g("", !0), V.value ? (i(), a("div", fs, [t("div", vs, [t("h4", gs, [s[44] || (s[44] = t("i", { class: "ki-duotone ki-add-square fs-2" }, [t("span", { class: "path1" }), t("span", { class: "path2" })], -1)), c(" " + o(F.value ? "Edit Credit Account" : "New Credit Account"), 1)]), t("button", { class: "btn btn-light btn-icon", onClick: H }, s[45] || (s[45] = [t("i", { class: "ki-duotone ki-cross fs-2" }, [t("span", { class: "path1" }), t("span", { class: "path2" })], -1)]))]), t("div", ms, [t("form", { onSubmit: K(lt, ["prevent"]), class: "d-flex flex-column gap-4" }, [t("div", null, [s[48] || (s[48] = t("label", { class: "form-label required fw-bold fs-6" }, "Supplier (Assigned Only)", -1)), _(t("select", { "onUpdate:modelValue": s[8] || (s[8] = e => p.SupplierID = e), required: "", class: "form-select form-select-lg" }, [s[46] || (s[46] = t("option", { value: "" }, "-- Select Supplier --", -1)), (i(!0), a(x, null, k(y.value, e => (i(), a("option", { key: e.SupplierID, value: e.SupplierID }, o(e.Name), 9, hs))), 128))], 512), [[X, p.SupplierID]]), y.value.length === 0 ? (i(), a("div", ys, s[47] || (s[47] = [c(" No assigned suppliers! "), t("br", null, null, -1), t("b", null, "Assign suppliers to this station first.", -1)]))) : g("", !0)]), t("div", null, [s[49] || (s[49] = t("label", { class: "form-label required fw-bold fs-6" }, "Credit Limit", -1)), _(t("input", { type: "number", min: "0", step: "0.01", "onUpdate:modelValue": s[9] || (s[9] = e => p.CreditLimit = e), class: "form-control form-control-lg", required: "" }, null, 512), [[Q, p.CreditLimit]])]), t("div", null, [s[50] || (s[50] = t("label", { class: "form-label fw-bold fs-6" }, "Payment Terms (Days)", -1)), _(t("input", { type: "number", min: "1", max: "180", "onUpdate:modelValue": s[10] || (s[10] = e => p.PaymentTermsDays = e), class: "form-control form-control-lg", required: "" }, null, 512), [[Q, p.PaymentTermsDays]])]), t("div", ws, [t("button", { class: "btn btn-light-success btn-lg w-100 fw-bold", disabled: E.value }, [E.value ? (i(), a("span", ks)) : g("", !0), s[51] || (s[51] = t("i", { class: "ki-duotone ki-check-square fs-2 me-2" }, [t("span", { class: "path1" }), t("span", { class: "path2" })], -1)), c(" " + o(F.value ? "Update Account" : "Create Account"), 1)], 8, xs)])], 32)])])) : g("", !0), A.value ? (i(), a("div", Ss, [t("div", Cs, [t("h4", As, [s[52] || (s[52] = t("i", { class: "ki-duotone ki-file-text fs-2" }, [t("span", { class: "path1" }), t("span", { class: "path2" })], -1)), c(" Account Details — " + o((n = C.value) == null ? void 0 : n.SupplierName), 1)]), t("button", { class: "btn btn-light btn-icon", onClick: s[11] || (s[11] = e => A.value = !1) }, s[53] || (s[53] = [t("i", { class: "ki-duotone ki-cross fs-2" }, [t("span", { class: "path1" }), t("span", { class: "path2" })], -1)]))]), t("div", Ds, [t("div", Is, [t("div", _s, [s[54] || (s[54] = t("div", { class: "fs-6 text-gray-700" }, "Credit Limit", -1)), t("div", $s, o(w(C.value.CreditLimit)), 1)]), t("div", Ts, [s[55] || (s[55] = t("div", { class: "fs-6 text-gray-700" }, "Outstanding", -1)), t("div", Ns, o(w(C.value.CurrentBalance)), 1)]), t("div", Bs, [s[56] || (s[56] = t("div", { class: "fs-6 text-gray-700" }, "Available Credit", -1)), t("div", Es, o(w(C.value.AvailableCredit)), 1)]), t("div", Ls, [s[57] || (s[57] = t("div", { class: "fs-6 text-gray-700" }, "Terms", -1)), t("div", Ps, o(C.value.PaymentTermsDays) + " days", 1)])]), s[62] || (s[62] = t("div", { class: "separator my-4" }, null, -1)), t("div", null, [s[61] || (s[61] = t("h5", { class: "fw-bold fs-4 mb-2 text-success d-flex align-items-center" }, [t("i", { class: "ki-duotone ki-timeline fs-2 me-2" }, [t("span", { class: "path1" }), t("span", { class: "path2" })]), c(" Credit Account Activity ")], -1)), G.value ? (i(), a("div", Us, s[58] || (s[58] = [t("span", { class: "spinner-border text-primary" }, null, -1)]))) : L.value.length === 0 ? (i(), a("div", qs, " No credit activity found. ")) : (i(), a("div", Os, [(i(!0), a(x, null, k(L.value, e => { var d; return i(), a("div", { key: e.TransactionID, class: "bg-light rounded-3 px-4 py-2 shadow-sm d-flex flex-row justify-content-between align-items-center" }, [t("div", js, [t("b", zs, o(e.TransactionType), 1), s[59] || (s[59] = c()), s[60] || (s[60] = t("br", null, null, -1)), t("span", Ms, o(e.Description), 1)]), t("div", null, [t("span", Rs, o(w(e.Amount)), 1), t("div", Vs, o((d = e.CreatedAt) == null ? void 0 : d.slice(0, 16).replace("T", " ")), 1)])]) }), 128))]))])])])) : g("", !0)]) } } }, Ws = rt(Fs, [["__scopeId", "data-v-91dd3bbc"]]); export { Ws as default };
