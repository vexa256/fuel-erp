import{_ as Mt,r as v,c as k,s as Dt,o as At,b as r,d as t,g as D,f as g,t as o,w as b,v as S,m as A,F as U,h as F,n as f,e as I,k as st,S as y,i as d}from"./index-BJk99QVQ.js";const jt={class:"d-flex flex-column gap-5"},Rt={class:"toolbar mb-5 mb-lg-7"},Bt={class:"container-xxl d-flex flex-stack flex-wrap"},Et={class:"d-flex align-items-center gap-2"},Vt=["disabled"],$t={class:"row g-5 g-xl-8"},Nt={class:"col-xl-3"},Lt={class:"card card-xl-stretch mb-xl-8",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"}},qt={class:"card-body text-center"},Ot={class:"text-white fw-bold fs-2hx"},Ht={class:"col-xl-3"},Jt={class:"card card-xl-stretch mb-xl-8",style:{background:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)"}},zt={class:"card-body text-center"},Gt={class:"text-white fw-bold fs-2hx"},Wt={class:"col-xl-3"},Xt={class:"card card-xl-stretch mb-xl-8",style:{background:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)"}},Yt={class:"card-body text-center"},Zt={class:"text-white fw-bold fs-2hx"},Kt={class:"col-xl-3"},Qt={class:"card card-xl-stretch mb-xl-8",style:{background:"linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)"}},te={class:"card-body text-center"},ee={class:"text-white fw-bold fs-2hx"},se={class:"row g-5 g-xl-8"},ae={class:"col-xl-6"},oe={class:"card card-xl-stretch mb-xl-8"},le={class:"card-body"},ne={class:"col-xl-6"},ie={class:"card card-xl-stretch mb-xl-8"},re={class:"card-body"},de={class:"card"},ce={class:"card-header border-0 pt-6"},ue={class:"card-title"},ve={class:"d-flex align-items-center position-relative my-1"},me={class:"card-toolbar"},pe={class:"d-flex justify-content-end align-items-center gap-3"},fe={class:"d-flex align-items-center gap-2"},ge=["value"],be={class:"card-body py-4"},he={class:"d-block d-lg-none"},xe={class:"card-body p-4"},ye={class:"d-flex justify-content-between align-items-start mb-3"},we={class:"fw-bold text-dark mb-1"},_e={class:"dropdown"},ke={class:"dropdown-menu menu menu-sub menu-sub-dropdown w-200px"},Pe={class:"menu-item px-3"},Ce=["onClick"],Se={class:"menu-item px-3"},Te=["onClick"],Ue={class:"menu-item px-3"},Fe=["onClick"],Ie={class:"row g-2 mb-3"},Me={class:"col-6"},De={class:"fw-bold text-dark"},Ae={class:"col-6"},je={class:"fw-bold text-primary"},Re={class:"col-6"},Be={class:"col-6"},Ee={class:"fw-bold text-info"},Ve={class:"d-flex justify-content-between align-items-center"},$e=["onClick"],Ne={class:"d-none d-lg-block"},Le={class:"table-responsive"},qe={class:"table align-middle table-row-dashed fs-6 gy-5"},Oe={class:"text-gray-600 fw-semibold"},He={class:"d-flex align-items-center"},Je={class:"symbol symbol-50px me-5"},ze={class:"d-flex justify-content-start flex-column"},Ge={class:"text-dark fw-bold text-hover-primary fs-6"},We={class:"text-muted fw-semibold text-muted d-block fs-7"},Xe={class:"text-end"},Ye={class:"fw-bold"},Ze={class:"text-end"},Ke={class:"text-primary fw-bold"},Qe={class:"text-end"},ts={class:"text-end"},es={class:"badge badge-light-info"},ss={class:"text-center"},as={class:"text-end"},os={class:"dropdown"},ls={class:"dropdown-menu menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-600 menu-state-bg-light-primary fw-semibold fs-7 w-200px py-4"},ns={class:"menu-item px-3"},is=["onClick"],rs={class:"menu-item px-3"},ds=["onClick"],cs={class:"menu-item px-3"},us=["onClick"],vs={class:"menu-item px-3"},ms=["onClick"],ps={class:"d-flex flex-stack flex-wrap pt-10"},fs={class:"fs-6 fw-semibold text-gray-700"},gs={class:"pagination"},bs=["onClick"],hs={class:"modal fade",id:"kt_modal_edit_product",tabindex:"-1"},xs={class:"modal-dialog modal-dialog-centered mw-650px"},ys={class:"modal-content"},ws={class:"modal-body py-10 px-lg-17"},_s={class:"scroll-y me-n7 pe-7",style:{"max-height":"400px"}},ks={class:"fv-row mb-7"},Ps={class:"row g-5 mb-7"},Cs={class:"col-6"},Ss={key:0,class:"invalid-feedback"},Ts={class:"col-6"},Us={key:0,class:"invalid-feedback"},Fs={class:"row g-5 mb-7"},Is={class:"col-6"},Ms={class:"col-6"},Ds={class:"fv-row mb-7"},As={class:"alert alert-primary d-flex align-items-center p-5"},js={class:"d-flex flex-column"},Rs={class:"fs-6"},Bs={class:"modal-footer flex-center"},Es=["disabled"],Vs={key:0,class:"spinner-border spinner-border-sm me-2"},$s={class:"modal fade",id:"kt_modal_product_details",tabindex:"-1"},Ns={class:"modal-dialog modal-dialog-centered mw-750px"},Ls={class:"modal-content"},qs={class:"modal-body"},Os={key:0,class:"d-flex flex-column gap-5"},Hs={class:"d-flex align-items-center"},Js={class:"symbol symbol-75px me-5"},zs={class:"flex-grow-1"},Gs={class:"text-dark fw-bold mb-1"},Ws={class:"text-muted fw-semibold"},Xs={class:"card bg-light-primary"},Ys={class:"card-body p-5"},Zs={class:"row g-5"},Ks={class:"col-6 col-md-3"},Qs={class:"fw-bold fs-4"},ta={class:"col-6 col-md-3"},ea={class:"fw-bold fs-4 text-primary"},sa={class:"col-6 col-md-3"},aa={class:"col-6 col-md-3"},oa={class:"fw-bold fs-4 text-info"},la={class:"row g-5"},na={class:"col-md-6"},ia={class:"card h-100"},ra={class:"card-body"},da={class:"table-responsive"},ca={class:"table table-borderless"},ua={class:"text-dark fw-bold"},va={class:"text-dark fw-bold"},ma={class:"text-dark fw-bold"},pa={class:"text-dark fw-bold"},fa={class:"col-md-6"},ga={class:"card h-100"},ba={class:"card-body"},ha={key:0},xa={class:"text-gray-600"},ya={class:"fw-bold"},wa={key:1,class:"text-center text-muted"},_a={class:"modal-footer"},ka={class:"modal fade",id:"kt_modal_bulk_pricing",tabindex:"-1"},Pa={class:"modal-dialog modal-dialog-centered mw-750px"},Ca={class:"modal-content"},Sa={class:"modal-body"},Ta={class:"row g-5"},Ua={class:"col-md-6"},Fa=["value"],Ia={class:"col-md-6"},Ma={class:"col-md-6"},Da={class:"required fw-semibold fs-6 mb-2"},Aa=["step"],ja={class:"col-md-6"},Ra={class:"col-12"},Ba={key:0,class:"col-12"},Ea={class:"card bg-light-info"},Va={class:"card-header"},$a={class:"card-title"},Na={class:"card-body",style:{"max-height":"200px","overflow-y":"auto"}},La={class:"fw-bold"},qa={class:"text-primary fw-bold"},Oa={key:0,class:"text-muted text-center"},Ha={class:"modal-footer"},Ja=["disabled"],za={key:0,class:"spinner-border spinner-border-sm me-2"},Ga={__name:"MgtPrice",setup(Wa){const c=v([]),j=v([]),X=v([]),q=v(!1),R=v(!1),B=v(!1),M=v(""),E=v(""),V=v(""),h=v(1),$=v(10),m=v(null),Y=v([]),O=v(null),H=v(null);let J=null,z=null;const n=v({ProductID:null,Name:"",UnitPrice:0,SellingPrice:0,TaxRate:0,ReorderLevel:0,Status:"Active"}),u=v({category:"",adjustmentType:"percentage",adjustmentValue:0,priceField:"SellingPrice",justification:""}),w=v([]),x=v({}),ct=()=>{try{const a=localStorage.getItem("jwt");return{"Content-Type":"application/json",...a&&{Authorization:`Bearer ${a}`}}}catch(a){return console.warn("Failed to get JWT token:",a),{"Content-Type":"application/json"}}},N=async(a,e={})=>{try{const s=await fetch(`https://backend.cloudfuelstationmis.com/api/records/v1${a}`,{headers:ct(),...e});if(!s.ok){let _=`HTTP ${s.status}: ${s.statusText}`;try{const T=await s.json();T.message&&(_=T.message)}catch{}throw new Error(_)}const l=s.headers.get("Content-Length"),i=s.headers.get("Content-Type");if(l==="0"||!(i!=null&&i.includes("application/json")))return{};const p=await s.text();if(!p)return{};try{return JSON.parse(p)}catch{return console.warn("Response is not valid JSON:",p),{}}}catch(s){throw console.error("API Request failed:",s),s}},ut=async()=>{try{const a=await N("/Products"),e=(a==null?void 0:a.records)||a||[];if(!Array.isArray(e)){console.warn("Unexpected response format:",a),c.value=[];return}c.value=e.map(s=>({...s,UnitPrice:parseFloat(s.UnitPrice)||0,SellingPrice:parseFloat(s.SellingPrice)||parseFloat(s.UnitPrice)||0,TaxRate:parseFloat(s.TaxRate)||0,ReorderLevel:parseFloat(s.ReorderLevel)||0}))}catch(a){throw console.error("Failed to fetch products:",a),c.value=[],new Error(`Failed to fetch products: ${a.message}`)}},vt=async()=>{try{const a=await N("/StationInventory"),e=(a==null?void 0:a.records)||a||[];j.value=Array.isArray(e)?e:[]}catch(a){console.error("Failed to fetch inventory:",a),j.value=[]}},mt=async()=>{try{const a=await N("/Stations"),e=(a==null?void 0:a.records)||a||[];X.value=Array.isArray(e)?e:[]}catch(a){console.error("Failed to fetch stations:",a),X.value=[]}},at=async()=>{q.value=!0;try{await Promise.all([ut(),vt(),mt()]),await st(),await Tt(),y.fire({title:"Success!",text:"Data refreshed successfully",icon:"success",toast:!0,position:"top-end",timer:2e3,showConfirmButton:!1})}catch(a){y.fire({title:"Error!",text:a.message,icon:"error",confirmButtonColor:"#f1416c"})}finally{q.value=!1}},pt=k(()=>c.value.length),ft=k(()=>c.value.reduce((a,e)=>{const l=j.value.filter(i=>i.ProductID===e.ProductID).reduce((i,p)=>i+(parseFloat(p.CurrentStock)||0),0);return a+l*e.SellingPrice},0)),gt=k(()=>c.value.length===0?0:c.value.reduce((e,s)=>e+P(s),0)/c.value.length),bt=k(()=>c.value.length===0?0:c.value.reduce((e,s)=>e+s.TaxRate,0)/c.value.length),L=k(()=>[...new Set(c.value.map(a=>a.ProductType))].sort()),G=k(()=>c.value.filter(a=>{const e=!M.value||a.Name.toLowerCase().includes(M.value.toLowerCase())||a.ProductType.toLowerCase().includes(M.value.toLowerCase()),s=!E.value||a.ProductType===E.value,l=!V.value||a.Status===V.value;return e&&s&&l})),Z=k(()=>Math.ceil(G.value.length/$.value)),ot=k(()=>{const a=(h.value-1)*$.value,e=a+$.value;return G.value.slice(a,e)}),ht=k(()=>{const a=[];let s=Math.max(1,h.value-Math.floor(2.5)),l=Math.min(Z.value,s+5-1);l-s<4&&(s=Math.max(1,l-5+1));for(let i=s;i<=l;i++)a.push(i);return a}),lt=k(()=>!n.value.UnitPrice||!n.value.SellingPrice?0:P(n.value)),P=a=>{const e=parseFloat(a.UnitPrice)||0,s=parseFloat(a.SellingPrice)||0;return s===0?0:(s-e)/s*100},C=a=>`UGX ${(parseFloat(a)||0).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})}`,nt=a=>{if(!a)return"N/A";try{return new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return"Invalid Date"}},K=a=>a==="Active"?"badge badge-light-success fs-8 fw-bold":"badge badge-light-danger fs-8 fw-bold",Q=a=>a>=20?"text-success fw-bold":a>=10?"text-warning fw-bold":"text-danger fw-bold",xt=a=>a>=20?"text-success":a>=10?"text-warning":"text-danger",tt=a=>({Fuel:"bg-light-primary text-primary",Lubricant:"bg-light-warning text-warning",Gas:"bg-light-success text-success",Other:"bg-light-info text-info"})[a]||"bg-light-secondary text-secondary",it=a=>({Fuel:"ki-duotone ki-oil-barrel fs-2",Lubricant:"ki-duotone ki-drop fs-2",Gas:"ki-duotone ki-gas-station fs-2",Other:"ki-duotone ki-element-11 fs-2"})[a]||"ki-duotone ki-element-11 fs-2",yt=a=>{const e=X.value.find(s=>s.StationID===a);return e?e.StationName:`Station ${a}`},W=a=>{var e;n.value={...a},x.value={};try{const s=document.getElementById("kt_modal_edit_product");s&&((e=window.bootstrap)!=null&&e.Modal)?new window.bootstrap.Modal(s).show():console.error("Modal element or Bootstrap not found")}catch(s){console.error("Failed to open edit modal:",s)}},rt=async a=>{var e;m.value=a,Y.value=j.value.filter(s=>s.ProductID===a.ProductID);try{const s=document.getElementById("kt_modal_product_details");s&&((e=window.bootstrap)!=null&&e.Modal)?new window.bootstrap.Modal(s).show():console.error("Modal element or Bootstrap not found")}catch(s){console.error("Failed to open details modal:",s)}},dt=a=>{y.fire({title:"Price History",text:`Price history for ${a.Name} will be implemented with audit logs from the database.`,icon:"info",confirmButtonColor:"#009EF7"})},wt=a=>{y.fire({title:"Duplicate Product",text:`Product duplication for ${a.Name} will create a new record in the Products table.`,icon:"info",confirmButtonColor:"#009EF7"})},_t=()=>{var a;u.value={category:"",adjustmentType:"percentage",adjustmentValue:0,priceField:"SellingPrice",justification:""},w.value=[];try{const e=document.getElementById("kt_modal_bulk_pricing");e&&((a=window.bootstrap)!=null&&a.Modal)?new window.bootstrap.Modal(e).show():console.error("Modal element or Bootstrap not found")}catch(e){console.error("Failed to open bulk pricing modal:",e)}},kt=()=>{if(!u.value.category||!u.value.adjustmentValue){y.fire({title:"Missing Information",text:"Please select a category and enter an adjustment value.",icon:"warning",confirmButtonColor:"#f1416c"});return}const a=c.value.filter(e=>e.ProductType===u.value.category);w.value=a.map(e=>{const s=e[u.value.priceField];let l;return u.value.adjustmentType==="percentage"?l=s*(1+u.value.adjustmentValue/100):l=s+u.value.adjustmentValue,{...e,currentPrice:s,newPrice:Math.max(0,l)}})},Pt=async()=>{if(w.value.length===0){y.fire({title:"No Changes",text:"Please generate a preview first.",icon:"warning",confirmButtonColor:"#f1416c"});return}if((await y.fire({title:"Confirm Bulk Update",text:`This will update ${w.value.length} products. Continue?`,icon:"question",showCancelButton:!0,confirmButtonColor:"#009EF7",cancelButtonColor:"#f1416c",confirmButtonText:"Yes, update prices"})).isConfirmed){B.value=!0;try{let e=0,s=0;for(const i of w.value)try{const p={[u.value.priceField]:i.newPrice.toString(),UpdatedAt:new Date().toISOString()};await N(`/Products/${i.ProductID}`,{method:"PATCH",body:JSON.stringify(p)});const _=c.value.findIndex(T=>T.ProductID===i.ProductID);_!==-1&&(c.value[_]={...c.value[_],[u.value.priceField]:i.newPrice}),e++}catch(p){console.error(`Failed to update product ${i.ProductID}:`,p),s++}e>0?y.fire({title:"Bulk Update Complete!",text:`${e} products updated successfully.${s>0?` ${s} failed.`:""}`,icon:e>s?"success":"warning",confirmButtonColor:"#50CD89"}):y.fire({title:"Update Failed!",text:"No products were updated successfully.",icon:"error",confirmButtonColor:"#f1416c"});const l=window.bootstrap.Modal.getInstance(document.getElementById("kt_modal_bulk_pricing"));l&&l.hide()}catch(e){y.fire({title:"Error!",text:e.message,icon:"error",confirmButtonColor:"#f1416c"})}finally{B.value=!1}}},Ct=()=>(x.value={},(!n.value.UnitPrice||n.value.UnitPrice<=0)&&(x.value.UnitPrice="Unit price must be greater than 0"),(!n.value.SellingPrice||n.value.SellingPrice<=0)&&(x.value.SellingPrice="Selling price must be greater than 0"),n.value.SellingPrice<n.value.UnitPrice&&(x.value.SellingPrice="Selling price cannot be less than unit price"),Object.keys(x.value).length===0),St=async()=>{var a;if(Ct()){R.value=!0;try{const e={UnitPrice:n.value.UnitPrice.toString(),SellingPrice:n.value.SellingPrice.toString(),TaxRate:n.value.TaxRate.toString(),ReorderLevel:((a=n.value.ReorderLevel)==null?void 0:a.toString())||"0",Status:n.value.Status,UpdatedAt:new Date().toISOString()},s=await N(`/Products/${n.value.ProductID}`,{method:"PATCH",body:JSON.stringify(e)}),l=c.value.findIndex(p=>p.ProductID===n.value.ProductID);l!==-1&&(c.value[l]={...c.value[l],...e}),y.fire({title:"Success!",text:"Product updated successfully.",icon:"success",toast:!0,position:"top-end",timer:3e3,showConfirmButton:!1});const i=window.bootstrap.Modal.getInstance(document.getElementById("kt_modal_edit_product"));i&&i.hide()}catch(e){y.fire({title:"Error!",text:e.message,icon:"error",confirmButtonColor:"#f1416c"})}finally{R.value=!1}}},Tt=async()=>{if(await st(),typeof window<"u"&&!window.Chart)try{await new Promise((a,e)=>{const s=document.createElement("script");s.src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js",s.onload=a,s.onerror=e,document.head.appendChild(s)})}catch(a){console.error("Failed to load Chart.js:",a);return}if(J&&(J.destroy(),J=null),z&&(z.destroy(),z=null),await st(),typeof window<"u"&&window.Chart&&O.value&&H.value)try{Ut(),Ft()}catch(a){console.error("Error initializing charts:",a)}},Ut=()=>{if(!(!O.value||!window.Chart))try{const a=O.value.getContext("2d"),e={};L.value.forEach(s=>{const l=c.value.filter(i=>i.ProductType===s);e[s]=l.reduce((i,p)=>{const T=j.value.filter(et=>et.ProductID===p.ProductID).reduce((et,It)=>et+(parseFloat(It.CurrentStock)||0),0);return i+T*p.SellingPrice},0)}),J=new window.Chart(a,{type:"doughnut",data:{labels:Object.keys(e),datasets:[{data:Object.values(e),backgroundColor:["#009EF7","#F1416C","#50CD89","#FFC700","#7239EA"]}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{usePointStyle:!0,padding:20}}}}})}catch(a){console.error("Error creating revenue chart:",a)}},Ft=()=>{if(!(!H.value||!window.Chart))try{const a=H.value.getContext("2d"),e=L.value.map(s=>{const l=c.value.filter(p=>p.ProductType===s);return l.length===0?0:l.reduce((p,_)=>p+P(_),0)/l.length});z=new window.Chart(a,{type:"bar",data:{labels:L.value,datasets:[{label:"Average Margin (%)",data:e,backgroundColor:"#009EF7",borderColor:"#009EF7",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,ticks:{callback:function(s){return s+"%"}}}}}})}catch(a){console.error("Error creating margin chart:",a)}};return Dt([M,E,V],()=>{h.value=1}),At(async()=>{await at()}),(a,e)=>(d(),r("div",jt,[t("div",Rt,[t("div",Bt,[e[19]||(e[19]=D('<div class="page-title d-flex flex-column me-3" data-v-115ca417><h1 class="d-flex text-dark fw-bold my-1 fs-3" data-v-115ca417>Pricing Management</h1><ul class="breadcrumb breadcrumb-dot fw-semibold text-gray-600 fs-7" data-v-115ca417><li class="breadcrumb-item text-gray-600" data-v-115ca417>Management</li><li class="breadcrumb-item text-gray-600" data-v-115ca417>Products</li><li class="breadcrumb-item text-gray-500" data-v-115ca417>Pricing</li></ul></div>',1)),t("div",Et,[t("button",{onClick:at,disabled:q.value,class:"btn btn-sm btn-light-primary"},[e[17]||(e[17]=t("i",{class:"ki-duotone ki-arrows-loop fs-3"},[t("span",{class:"path1"}),t("span",{class:"path2"})],-1)),g(" "+o(q.value?"Loading...":"Refresh"),1)],8,Vt),t("button",{onClick:_t,class:"btn btn-sm btn-primary"},e[18]||(e[18]=[t("i",{class:"ki-duotone ki-price-tag fs-3"},[t("span",{class:"path1"}),t("span",{class:"path2"}),t("span",{class:"path3"})],-1),g(" Bulk Pricing ")]))])])]),t("div",$t,[t("div",Nt,[t("div",Lt,[t("div",qt,[e[20]||(e[20]=t("i",{class:"ki-duotone ki-dollar fs-3x text-white mb-3"},[t("span",{class:"path1"}),t("span",{class:"path2"}),t("span",{class:"path3"})],-1)),t("div",Ot,o(C(ft.value)),1),e[21]||(e[21]=t("div",{class:"text-white opacity-75 fw-semibold fs-7"},"Total Revenue",-1))])])]),t("div",Ht,[t("div",Jt,[t("div",zt,[e[22]||(e[22]=t("i",{class:"ki-duotone ki-package fs-3x text-white mb-3"},[t("span",{class:"path1"}),t("span",{class:"path2"}),t("span",{class:"path3"})],-1)),t("div",Gt,o(pt.value),1),e[23]||(e[23]=t("div",{class:"text-white opacity-75 fw-semibold fs-7"},"Total Products",-1))])])]),t("div",Wt,[t("div",Xt,[t("div",Yt,[e[24]||(e[24]=t("i",{class:"ki-duotone ki-chart-pie-4 fs-3x text-white mb-3"},[t("span",{class:"path1"}),t("span",{class:"path2"}),t("span",{class:"path3"})],-1)),t("div",Zt,o(gt.value.toFixed(1))+"%",1),e[25]||(e[25]=t("div",{class:"text-white opacity-75 fw-semibold fs-7"},"Average Margin",-1))])])]),t("div",Kt,[t("div",Qt,[t("div",te,[e[26]||(e[26]=t("i",{class:"ki-duotone ki-percentage fs-3x text-white mb-3"},[t("span",{class:"path1"}),t("span",{class:"path2"})],-1)),t("div",ee,o(bt.value.toFixed(1))+"%",1),e[27]||(e[27]=t("div",{class:"text-white opacity-75 fw-semibold fs-7"},"Average Tax Rate",-1))])])])]),t("div",se,[t("div",ae,[t("div",oe,[e[28]||(e[28]=t("div",{class:"card-header border-0 pt-5"},[t("h3",{class:"card-title align-items-start flex-column"},[t("span",{class:"card-label fw-bold fs-3 mb-1"},"Revenue by Category"),t("span",{class:"text-muted fw-semibold fs-7"},"Current month performance")])],-1)),t("div",le,[t("canvas",{ref_key:"revenueChart",ref:O,style:{height:"300px"}},null,512)])])]),t("div",ne,[t("div",ie,[e[29]||(e[29]=t("div",{class:"card-header border-0 pt-5"},[t("h3",{class:"card-title align-items-start flex-column"},[t("span",{class:"card-label fw-bold fs-3 mb-1"},"Profit Margins"),t("span",{class:"text-muted fw-semibold fs-7"},"By product category")])],-1)),t("div",re,[t("canvas",{ref_key:"marginChart",ref:H,style:{height:"300px"}},null,512)])])])]),t("div",de,[t("div",ce,[t("div",ue,[t("div",ve,[e[30]||(e[30]=t("i",{class:"ki-duotone ki-magnifier fs-3 position-absolute ms-5"},[t("span",{class:"path1"}),t("span",{class:"path2"})],-1)),b(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=s=>M.value=s),class:"form-control form-control-solid w-250px ps-13",placeholder:"Search products..."},null,512),[[S,M.value]])])]),t("div",me,[t("div",pe,[t("div",fe,[b(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>E.value=s),class:"form-select form-select-solid w-150px"},[e[31]||(e[31]=t("option",{value:""},"All Categories",-1)),(d(!0),r(U,null,F(L.value,s=>(d(),r("option",{key:s,value:s},o(s),9,ge))),128))],512),[[A,E.value]]),b(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>V.value=s),class:"form-select form-select-solid w-150px"},e[32]||(e[32]=[t("option",{value:""},"All Status",-1),t("option",{value:"Active"},"Active",-1),t("option",{value:"Inactive"},"Inactive",-1)]),512),[[A,V.value]])])])])]),t("div",be,[t("div",he,[(d(!0),r(U,null,F(ot.value,s=>(d(),r("div",{key:s.ProductID,class:"card border mb-3"},[t("div",xe,[t("div",ye,[t("div",null,[t("h6",we,o(s.Name),1),t("span",{class:f(["badge",tt(s.ProductType)])},o(s.ProductType),3)]),t("div",_e,[e[36]||(e[36]=D('<button class="btn btn-sm btn-light btn-active-light-primary" data-bs-toggle="dropdown" data-v-115ca417><i class="ki-duotone ki-dots-vertical fs-5" data-v-115ca417><span class="path1" data-v-115ca417></span><span class="path2" data-v-115ca417></span><span class="path3" data-v-115ca417></span></i></button>',1)),t("div",ke,[t("div",Pe,[t("a",{onClick:l=>W(s),class:"menu-link px-3"},e[33]||(e[33]=[t("i",{class:"ki-duotone ki-pencil fs-6 me-2"},[t("span",{class:"path1"}),t("span",{class:"path2"})],-1),g("Edit Pricing ")]),8,Ce)]),t("div",Se,[t("a",{onClick:l=>rt(s),class:"menu-link px-3"},e[34]||(e[34]=[t("i",{class:"ki-duotone ki-eye fs-6 me-2"},[t("span",{class:"path1"}),t("span",{class:"path2"}),t("span",{class:"path3"})],-1),g("View Details ")]),8,Te)]),t("div",Ue,[t("a",{onClick:l=>dt(s),class:"menu-link px-3"},e[35]||(e[35]=[t("i",{class:"ki-duotone ki-chart-line fs-6 me-2"},[t("span",{class:"path1"}),t("span",{class:"path2"}),t("span",{class:"path3"})],-1),g("Price History ")]),8,Fe)])])])]),t("div",Ie,[t("div",Me,[e[37]||(e[37]=t("div",{class:"text-gray-600 fs-8"},"Unit Price",-1)),t("div",De,o(C(s.UnitPrice)),1)]),t("div",Ae,[e[38]||(e[38]=t("div",{class:"text-gray-600 fs-8"},"Selling Price",-1)),t("div",je,o(C(s.SellingPrice)),1)]),t("div",Re,[e[39]||(e[39]=t("div",{class:"text-gray-600 fs-8"},"Margin",-1)),t("div",{class:f(Q(P(s)))},o(P(s).toFixed(1))+"% ",3)]),t("div",Be,[e[40]||(e[40]=t("div",{class:"text-gray-600 fs-8"},"Tax Rate",-1)),t("div",Ee,o(s.TaxRate)+"%",1)])]),t("div",Ve,[t("span",{class:f(K(s.Status))},o(s.Status),3),t("button",{onClick:l=>W(s),class:"btn btn-sm btn-primary"},e[41]||(e[41]=[t("i",{class:"ki-duotone ki-pencil fs-4"},[t("span",{class:"path1"}),t("span",{class:"path2"})],-1),g("Edit ")]),8,$e)])])]))),128))]),t("div",Ne,[t("div",Le,[t("table",qe,[e[49]||(e[49]=t("thead",null,[t("tr",{class:"text-start text-muted fw-bold fs-7 text-uppercase gs-0"},[t("th",{class:"min-w-200px"},"Product"),t("th",{class:"min-w-100px text-end"},"Unit Price"),t("th",{class:"min-w-100px text-end"},"Selling Price"),t("th",{class:"min-w-100px text-end"},"Margin"),t("th",{class:"min-w-100px text-end"},"Tax Rate"),t("th",{class:"min-w-100px text-center"},"Status"),t("th",{class:"text-end min-w-100px"},"Actions")])],-1)),t("tbody",Oe,[(d(!0),r(U,null,F(ot.value,s=>(d(),r("tr",{key:s.ProductID},[t("td",null,[t("div",He,[t("div",Je,[t("span",{class:f(["symbol-label",tt(s.ProductType)])},[t("i",{class:f(it(s.ProductType))},e[42]||(e[42]=[t("span",{class:"path1"},null,-1),t("span",{class:"path2"},null,-1)]),2)],2)]),t("div",ze,[t("span",Ge,o(s.Name),1),t("span",We,o(s.ProductType),1)])])]),t("td",Xe,[t("span",Ye,o(C(s.UnitPrice)),1)]),t("td",Ze,[t("span",Ke,o(C(s.SellingPrice)),1)]),t("td",Qe,[t("span",{class:f(Q(P(s)))},o(P(s).toFixed(1))+"% ",3)]),t("td",ts,[t("span",es,o(s.TaxRate)+"%",1)]),t("td",ss,[t("span",{class:f(K(s.Status))},o(s.Status),3)]),t("td",as,[t("div",os,[e[48]||(e[48]=t("button",{class:"btn btn-light btn-active-light-primary btn-sm","data-bs-toggle":"dropdown"},[g(" Actions "),t("i",{class:"ki-duotone ki-down fs-5 m-0"},[t("span",{class:"path1"}),t("span",{class:"path2"})])],-1)),t("div",ls,[t("div",ns,[t("a",{onClick:l=>W(s),class:"menu-link px-3"},e[43]||(e[43]=[t("i",{class:"ki-duotone ki-pencil fs-6 me-2"},[t("span",{class:"path1"}),t("span",{class:"path2"})],-1),g("Edit Pricing ")]),8,is)]),t("div",rs,[t("a",{onClick:l=>rt(s),class:"menu-link px-3"},e[44]||(e[44]=[t("i",{class:"ki-duotone ki-eye fs-6 me-2"},[t("span",{class:"path1"}),t("span",{class:"path2"}),t("span",{class:"path3"})],-1),g("View Details ")]),8,ds)]),t("div",cs,[t("a",{onClick:l=>dt(s),class:"menu-link px-3"},e[45]||(e[45]=[t("i",{class:"ki-duotone ki-chart-line fs-6 me-2"},[t("span",{class:"path1"}),t("span",{class:"path2"}),t("span",{class:"path3"})],-1),g("Price History ")]),8,us)]),e[47]||(e[47]=t("div",{class:"separator my-2"},null,-1)),t("div",vs,[t("a",{onClick:l=>wt(s),class:"menu-link px-3"},e[46]||(e[46]=[t("i",{class:"ki-duotone ki-copy fs-6 me-2"},[t("span",{class:"path1"}),t("span",{class:"path2"})],-1),g("Duplicate ")]),8,ms)])])])])]))),128))])])])]),t("div",ps,[t("div",fs," Showing "+o((h.value-1)*$.value+1)+" to "+o(Math.min(h.value*$.value,G.value.length))+" of "+o(G.value.length)+" entries ",1),t("ul",gs,[t("li",{class:f(["page-item",{disabled:h.value===1}])},[t("a",{onClick:e[3]||(e[3]=s=>h.value=Math.max(1,h.value-1)),class:"page-link"},e[50]||(e[50]=[t("i",{class:"previous"},null,-1)]))],2),(d(!0),r(U,null,F(ht.value,s=>(d(),r("li",{key:s,class:f(["page-item",{active:s===h.value}])},[t("a",{onClick:l=>h.value=s,class:"page-link"},o(s),9,bs)],2))),128)),t("li",{class:f(["page-item",{disabled:h.value===Z.value}])},[t("a",{onClick:e[4]||(e[4]=s=>h.value=Math.min(Z.value,h.value+1)),class:"page-link"},e[51]||(e[51]=[t("i",{class:"next"},null,-1)]))],2)])])])]),t("div",hs,[t("div",xs,[t("div",ys,[e[63]||(e[63]=D('<div class="modal-header" data-v-115ca417><h2 class="fw-bold" data-v-115ca417>Edit Product Pricing</h2><div class="btn btn-icon btn-sm btn-active-icon-primary" data-bs-dismiss="modal" data-v-115ca417><i class="ki-duotone ki-cross fs-1" data-v-115ca417><span class="path1" data-v-115ca417></span><span class="path2" data-v-115ca417></span></i></div></div>',1)),t("div",ws,[t("div",_s,[t("div",ks,[e[52]||(e[52]=t("label",{class:"fw-semibold fs-6 mb-2"},"Product Name",-1)),b(t("input",{type:"text","onUpdate:modelValue":e[5]||(e[5]=s=>n.value.Name=s),class:"form-control form-control-solid mb-3 mb-lg-0",readonly:""},null,512),[[S,n.value.Name]])]),t("div",Ps,[t("div",Cs,[e[53]||(e[53]=t("label",{class:"required fw-semibold fs-6 mb-2"},"Unit Price",-1)),b(t("input",{type:"number","onUpdate:modelValue":e[6]||(e[6]=s=>n.value.UnitPrice=s),class:f(["form-control form-control-solid",{"is-invalid":x.value.UnitPrice}]),step:"0.01",min:"0",required:""},null,2),[[S,n.value.UnitPrice,void 0,{number:!0}]]),x.value.UnitPrice?(d(),r("div",Ss,o(x.value.UnitPrice),1)):I("",!0)]),t("div",Ts,[e[54]||(e[54]=t("label",{class:"required fw-semibold fs-6 mb-2"},"Selling Price",-1)),b(t("input",{type:"number","onUpdate:modelValue":e[7]||(e[7]=s=>n.value.SellingPrice=s),class:f(["form-control form-control-solid",{"is-invalid":x.value.SellingPrice}]),step:"0.01",min:"0",required:""},null,2),[[S,n.value.SellingPrice,void 0,{number:!0}]]),x.value.SellingPrice?(d(),r("div",Us,o(x.value.SellingPrice),1)):I("",!0)])]),t("div",Fs,[t("div",Is,[e[55]||(e[55]=t("label",{class:"fw-semibold fs-6 mb-2"},"Tax Rate (%)",-1)),b(t("input",{type:"number","onUpdate:modelValue":e[8]||(e[8]=s=>n.value.TaxRate=s),class:"form-control form-control-solid",step:"0.01",min:"0",max:"100"},null,512),[[S,n.value.TaxRate,void 0,{number:!0}]])]),t("div",Ms,[e[56]||(e[56]=t("label",{class:"fw-semibold fs-6 mb-2"},"Reorder Level",-1)),b(t("input",{type:"number","onUpdate:modelValue":e[9]||(e[9]=s=>n.value.ReorderLevel=s),class:"form-control form-control-solid",min:"0"},null,512),[[S,n.value.ReorderLevel,void 0,{number:!0}]])])]),t("div",Ds,[e[58]||(e[58]=t("label",{class:"fw-semibold fs-6 mb-2"},"Status",-1)),b(t("select",{"onUpdate:modelValue":e[10]||(e[10]=s=>n.value.Status=s),class:"form-select form-select-solid"},e[57]||(e[57]=[t("option",{value:"Active"},"Active",-1),t("option",{value:"Inactive"},"Inactive",-1)]),512),[[A,n.value.Status]])]),t("div",As,[e[61]||(e[61]=t("i",{class:"ki-duotone ki-shield-tick fs-2hx text-primary me-4"},[t("span",{class:"path1"}),t("span",{class:"path2"}),t("span",{class:"path3"})],-1)),t("div",js,[e[60]||(e[60]=t("h4",{class:"mb-1 text-dark"},"Profit Margin Preview",-1)),t("span",Rs,[e[59]||(e[59]=g("Calculated margin: ")),t("strong",{class:f(Q(lt.value))},o(lt.value.toFixed(2))+"%",3)])])])])]),t("div",Bs,[e[62]||(e[62]=t("button",{type:"button",class:"btn btn-light me-3","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{onClick:St,class:"btn btn-primary",disabled:R.value},[R.value?(d(),r("span",Vs)):I("",!0),g(" "+o(R.value?"Saving...":"Save Changes"),1)],8,Es)])])])]),t("div",$s,[t("div",Ns,[t("div",Ls,[e[77]||(e[77]=D('<div class="modal-header" data-v-115ca417><h2 class="fw-bold" data-v-115ca417>Product Details</h2><div class="btn btn-icon btn-sm btn-active-icon-primary" data-bs-dismiss="modal" data-v-115ca417><i class="ki-duotone ki-cross fs-1" data-v-115ca417><span class="path1" data-v-115ca417></span><span class="path2" data-v-115ca417></span></i></div></div>',1)),t("div",qs,[m.value?(d(),r("div",Os,[t("div",Hs,[t("div",Js,[t("span",{class:f(["symbol-label",tt(m.value.ProductType)])},[t("i",{class:f(it(m.value.ProductType))},e[64]||(e[64]=[t("span",{class:"path1"},null,-1),t("span",{class:"path2"},null,-1)]),2)],2)]),t("div",zs,[t("h3",Gs,o(m.value.Name),1),t("div",Ws,o(m.value.Description||"No description available"),1)]),t("span",{class:f(K(m.value.Status))},o(m.value.Status),3)]),t("div",Xs,[t("div",Ys,[t("div",Zs,[t("div",Ks,[e[65]||(e[65]=t("div",{class:"text-gray-600 fs-7"},"Unit Price",-1)),t("div",Qs,o(C(m.value.UnitPrice)),1)]),t("div",ta,[e[66]||(e[66]=t("div",{class:"text-gray-600 fs-7"},"Selling Price",-1)),t("div",ea,o(C(m.value.SellingPrice)),1)]),t("div",sa,[e[67]||(e[67]=t("div",{class:"text-gray-600 fs-7"},"Profit Margin",-1)),t("div",{class:f(["fw-bold fs-4",xt(P(m.value))])},o(P(m.value).toFixed(1))+"% ",3)]),t("div",aa,[e[68]||(e[68]=t("div",{class:"text-gray-600 fs-7"},"Tax Rate",-1)),t("div",oa,o(m.value.TaxRate)+"%",1)])])])]),t("div",la,[t("div",na,[t("div",ia,[e[73]||(e[73]=t("div",{class:"card-header"},[t("h5",{class:"card-title"},"Product Information")],-1)),t("div",ra,[t("div",da,[t("table",ca,[t("tr",null,[e[69]||(e[69]=t("td",{class:"text-gray-600 fw-semibold"},"Product Type:",-1)),t("td",ua,o(m.value.ProductType),1)]),t("tr",null,[e[70]||(e[70]=t("td",{class:"text-gray-600 fw-semibold"},"Reorder Level:",-1)),t("td",va,o(m.value.ReorderLevel||"Not set"),1)]),t("tr",null,[e[71]||(e[71]=t("td",{class:"text-gray-600 fw-semibold"},"Created:",-1)),t("td",ma,o(nt(m.value.CreatedAt)),1)]),t("tr",null,[e[72]||(e[72]=t("td",{class:"text-gray-600 fw-semibold"},"Updated:",-1)),t("td",pa,o(nt(m.value.UpdatedAt)),1)])])])])])]),t("div",fa,[t("div",ga,[e[74]||(e[74]=t("div",{class:"card-header"},[t("h5",{class:"card-title"},"Inventory Summary")],-1)),t("div",ba,[Y.value.length>0?(d(),r("div",ha,[(d(!0),r(U,null,F(Y.value,s=>(d(),r("div",{key:s.InventoryID,class:"d-flex justify-content-between align-items-center mb-3"},[t("span",xa,o(yt(s.StationID)),1),t("span",ya,o(s.CurrentStock||0)+" units",1)]))),128))])):(d(),r("div",wa,"No inventory data available"))])])])])])):I("",!0)]),t("div",_a,[e[76]||(e[76]=t("button",{type:"button",class:"btn btn-light","data-bs-dismiss":"modal"},"Close",-1)),t("button",{onClick:e[11]||(e[11]=s=>W(m.value)),class:"btn btn-primary","data-bs-dismiss":"modal"},e[75]||(e[75]=[t("i",{class:"ki-duotone ki-pencil fs-3"},[t("span",{class:"path1"}),t("span",{class:"path2"})],-1),g("Edit Pricing ")]))])])])]),t("div",ka,[t("div",Pa,[t("div",Ca,[e[87]||(e[87]=D('<div class="modal-header" data-v-115ca417><h2 class="fw-bold" data-v-115ca417>Bulk Pricing Update</h2><div class="btn btn-icon btn-sm btn-active-icon-primary" data-bs-dismiss="modal" data-v-115ca417><i class="ki-duotone ki-cross fs-1" data-v-115ca417><span class="path1" data-v-115ca417></span><span class="path2" data-v-115ca417></span></i></div></div>',1)),t("div",Sa,[t("div",Ta,[e[85]||(e[85]=D('<div class="col-12" data-v-115ca417><div class="notice d-flex bg-light-warning rounded border-warning border border-dashed p-6" data-v-115ca417><i class="ki-duotone ki-information fs-2tx text-warning me-4" data-v-115ca417><span class="path1" data-v-115ca417></span><span class="path2" data-v-115ca417></span><span class="path3" data-v-115ca417></span></i><div class="d-flex flex-stack flex-grow-1" data-v-115ca417><div class="fw-semibold" data-v-115ca417><h4 class="text-gray-900 fw-bold" data-v-115ca417>Bulk Pricing Update</h4><div class="fs-6 text-gray-700" data-v-115ca417> Apply percentage changes to multiple products at once. Changes will require approval for amounts above your authorization limit. </div></div></div></div></div>',1)),t("div",Ua,[e[79]||(e[79]=t("label",{class:"required fw-semibold fs-6 mb-2"},"Product Category",-1)),b(t("select",{"onUpdate:modelValue":e[12]||(e[12]=s=>u.value.category=s),class:"form-select form-select-solid"},[e[78]||(e[78]=t("option",{value:""},"Select Category",-1)),(d(!0),r(U,null,F(L.value,s=>(d(),r("option",{key:s,value:s},o(s),9,Fa))),128))],512),[[A,u.value.category]])]),t("div",Ia,[e[81]||(e[81]=t("label",{class:"required fw-semibold fs-6 mb-2"},"Adjustment Type",-1)),b(t("select",{"onUpdate:modelValue":e[13]||(e[13]=s=>u.value.adjustmentType=s),class:"form-select form-select-solid"},e[80]||(e[80]=[t("option",{value:"percentage"},"Percentage Change",-1),t("option",{value:"fixed"},"Fixed Amount",-1)]),512),[[A,u.value.adjustmentType]])]),t("div",Ma,[t("label",Da,o(u.value.adjustmentType==="percentage"?"Percentage (%)":"Amount (UGX)"),1),b(t("input",{type:"number","onUpdate:modelValue":e[14]||(e[14]=s=>u.value.adjustmentValue=s),class:"form-control form-control-solid",step:u.value.adjustmentType==="percentage"?"0.01":"1",required:""},null,8,Aa),[[S,u.value.adjustmentValue,void 0,{number:!0}]])]),t("div",ja,[e[83]||(e[83]=t("label",{class:"required fw-semibold fs-6 mb-2"},"Price Field",-1)),b(t("select",{"onUpdate:modelValue":e[15]||(e[15]=s=>u.value.priceField=s),class:"form-select form-select-solid"},e[82]||(e[82]=[t("option",{value:"SellingPrice"},"Selling Price",-1),t("option",{value:"UnitPrice"},"Unit Price",-1)]),512),[[A,u.value.priceField]])]),t("div",Ra,[e[84]||(e[84]=t("label",{class:"fw-semibold fs-6 mb-2"},"Justification",-1)),b(t("textarea",{"onUpdate:modelValue":e[16]||(e[16]=s=>u.value.justification=s),class:"form-control form-control-solid",rows:"3",placeholder:"Provide justification for this pricing change..."},null,512),[[S,u.value.justification]])]),w.value.length>0?(d(),r("div",Ba,[t("div",Ea,[t("div",Va,[t("h5",$a,"Preview Changes ("+o(w.value.length)+" products)",1)]),t("div",Na,[(d(!0),r(U,null,F(w.value.slice(0,5),s=>(d(),r("div",{key:s.ProductID,class:"d-flex justify-content-between align-items-center mb-2"},[t("span",La,o(s.Name),1),t("span",null,[g(o(C(s.currentPrice))+" â†’ ",1),t("span",qa,o(C(s.newPrice)),1)])]))),128)),w.value.length>5?(d(),r("div",Oa," ... and "+o(w.value.length-5)+" more products ",1)):I("",!0)])])])):I("",!0)])]),t("div",Ha,[e[86]||(e[86]=t("button",{type:"button",class:"btn btn-light me-3","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{onClick:kt,type:"button",class:"btn btn-info me-3"}," Preview Changes "),t("button",{onClick:Pt,class:"btn btn-primary",disabled:B.value||w.value.length===0},[B.value?(d(),r("span",za)):I("",!0),g(" "+o(B.value?"Applying...":"Apply Changes"),1)],8,Ja)])])])])]))}},Ya=Mt(Ga,[["__scopeId","data-v-115ca417"]]);export{Ya as default};
